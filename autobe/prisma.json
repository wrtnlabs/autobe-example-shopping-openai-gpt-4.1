{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"shopping_mall_ai_backend_channels","description":"Represents a top-level sales channel (web, app, affiliate) with independent branding, configuration, and legal context. Forms the root of all section/category taxonomies. Other domains reference this for scoping users, products, promotions, and analytics. Supports cross-channel commerce and coordinated operations.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","description":"Business channel code, unique across all channels, used for business logic referencing and integration.","nullable":false},{"name":"name","type":"string","description":"Public display name for the channel.","nullable":false},{"name":"description","type":"string","description":"Detailed channel description, including business usage, for admin/reference.","nullable":true},{"name":"country","type":"string","description":"Country or region for compliance and default settings. ISO 3166-1 (alpha-2).","nullable":false},{"name":"currency","type":"string","description":"Default currency for transactions in this channel (ISO 4217 codes e.g. KRW, USD, EUR).","nullable":false},{"name":"language","type":"string","description":"Default language for this channel (IETF language tag).","nullable":false},{"name":"timezone","type":"string","description":"Default timezone of the channel (IANA/Olson database format).","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of channel creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last channel update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp of soft deletion, if applicable.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["country"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_channel_sections","description":"Defines a section structure (e.g., home, sale, featured) for a channel. Each section is scoped by channel and optionally organized hierarchically (nested sections). Supports business navigation, personalization, and analytics segmentation.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_channel_id","type":"uuid","description":"Parent channel's {@link shopping_mall_ai_backend_channels.id}. Section belongs to a single channel.","relation":{"name":"channel","targetModel":"shopping_mall_ai_backend_channels"},"unique":false,"nullable":false},{"name":"parent_id","type":"uuid","description":"Optional parent section for nested section hierarchy. Self-referencing to allow tree structure.","relation":{"name":"parent","targetModel":"shopping_mall_ai_backend_channel_sections","mappingName":"recursive"},"unique":false,"nullable":true}],"plainFields":[{"name":"code","type":"string","description":"Section code, unique within channel.","nullable":false},{"name":"name","type":"string","description":"Display name for section/navigation.","nullable":false},{"name":"description","type":"string","description":"Section business purpose/admin memo.","nullable":true},{"name":"order","type":"int","description":"Order for visual sorting/navigation; lower numbers are shown first.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of section creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp of soft deletion, if present.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_channel_id","code"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_channel_id","order"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_channel_categories","description":"Represents category definitions for a channel (e.g., 'Home Decor', 'Electronics'). Each category is scoped by channel. Supports navigation, filtering, analytics. Allows nesting (tree structure) with parent-child relationships.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_channel_id","type":"uuid","description":"Channel's {@link shopping_mall_ai_backend_channels.id}. Category is assigned to a channel.","relation":{"name":"channel","targetModel":"shopping_mall_ai_backend_channels"},"unique":false,"nullable":false},{"name":"parent_id","type":"uuid","description":"Optional parent category for nested category trees.","relation":{"name":"parent","targetModel":"shopping_mall_ai_backend_channel_categories","mappingName":"recursive"},"unique":false,"nullable":true}],"plainFields":[{"name":"code","type":"string","description":"Category code, unique within channel.","nullable":false},{"name":"name","type":"string","description":"Category display name.","nullable":false},{"name":"description","type":"string","description":"Business/admin context for category.","nullable":true},{"name":"order","type":"int","description":"Order for display or priority within channel.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp, if any.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_channel_id","code"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_channel_id","order"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_channel_category_mappings","description":"Subsidiary mapping table for cross-channel or section-to-category assignments—e.g., mapping category trees or sharing categories across sections/channels. Not user-manageable; enables complex navigation or analytics relationships.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_channel_section_id","type":"uuid","description":"Section to which the category is mapped {@link shopping_mall_ai_backend_channel_sections.id}.","relation":{"name":"section","targetModel":"shopping_mall_ai_backend_channel_sections"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_channel_category_id","type":"uuid","description":"Mapped category's {@link shopping_mall_ai_backend_channel_categories.id}.","relation":{"name":"category","targetModel":"shopping_mall_ai_backend_channel_categories"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Mapping creation timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_channel_section_id","shopping_mall_ai_backend_channel_category_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_system_configs","description":"Key-value configuration table for global and system context. Governs business logic, operational flags, feature toggles, and platform-wide parameters. Referenced by all domains—enables dynamic config management and auditability.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"key","type":"string","description":"Unique config key. Scope: global, unless per-channel or per-feature. Used by application logic for config lookup.","nullable":false},{"name":"value","type":"string","description":"Serialized value in standard format (e.g. JSON or string).","nullable":false},{"name":"description","type":"string","description":"Business/admin facing explanation of config parameter.","nullable":true},{"name":"effective_from","type":"datetime","description":"Config effectivity start time (for scheduled/conditional configs).","nullable":true},{"name":"effective_to","type":"datetime","description":"Optional: config end time.","nullable":true},{"name":"created_at","type":"datetime","description":"Time of creation/insert.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Time of soft deletion, if any.","nullable":true}],"uniqueIndexes":[{"fieldNames":["key"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_system_audit_trails","description":"Global system audit trail for configuration changes, platform events, and sensitive operations. Used for regulatory compliance, business evidence, and tamper-proof operational history. Each entry is immutable and append-only.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"event_type","type":"string","description":"Type of event (enum: config_change, access, permission, error, etc.).","nullable":false},{"name":"actor_id","type":"uuid","description":"Reference to acting user, seller, admin, etc. (UUID from other tables). Business context dependent.","nullable":false},{"name":"description","type":"string","description":"Human-readable business context and event details.","nullable":false},{"name":"metadata","type":"string","description":"Serialized details/metadata (JSON or text) for technical audit.","nullable":true},{"name":"created_at","type":"datetime","description":"Time of event occurrence.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["event_type"]},{"fieldNames":["actor_id"]}],"ginIndexes":[{"fieldName":"description"}]},{"name":"shopping_mall_ai_backend_files","description":"System-wide files/attachments metadata table. Used across all business domains for referencing uploads, compliance records, and evidence. Tracks file lifecycle, storage, size, and linkage to business entities. Enables content audit, ownership, and secure access controls.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"original_filename","type":"string","description":"User-supplied source filename (immutable, for audit).","nullable":false},{"name":"mime_type","type":"string","description":"File content-type (IANA, e.g. image/png, application/pdf).","nullable":false},{"name":"storage_uri","type":"uri","description":"URI/reference to blob/object store or file service.","nullable":false},{"name":"size_bytes","type":"int","description":"File size in bytes.","nullable":false},{"name":"uploaded_by_id","type":"uuid","description":"Uploader's UUID (customer, seller, admin reference).","nullable":false},{"name":"uploaded_at","type":"datetime","description":"File upload timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Logical deletion timestamp (if any).","nullable":true}],"uniqueIndexes":[{"fieldNames":["storage_uri"],"unique":true}],"plainIndexes":[{"fieldNames":["uploaded_by_id"]}],"ginIndexes":[{"fieldName":"original_filename"}]},{"name":"shopping_mall_ai_backend_codebooks","description":"Represents a codebook (lookup dictionary) containing business labels/codes. Used for status, types, region lists, option tags, etc. Each codebook groups related codes for use in various domain contexts. Managed independently (e.g., status values, option types).","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","description":"Business codebook identifier (unique).","nullable":false},{"name":"name","type":"string","description":"Codebook display name for reference/admin UI.","nullable":false},{"name":"description","type":"string","description":"Business context, usage, and memo for admins.","nullable":true},{"name":"created_at","type":"datetime","description":"Time of creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Time of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time, if present.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_codebook_entries","description":"Entries/values within a codebook, e.g. statuses, tags, option values. Each entry is assigned to a parent codebook and has business visibility rules (show/hide) and ordering. Not independently managed.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_codebook_id","type":"uuid","description":"Parent codebook's {@link shopping_mall_ai_backend_codebooks.id}.","relation":{"name":"codebook","targetModel":"shopping_mall_ai_backend_codebooks"},"unique":false,"nullable":false}],"plainFields":[{"name":"code","type":"string","description":"Entry code, unique within codebook.","nullable":false},{"name":"label","type":"string","description":"Human display label for this entry.","nullable":false},{"name":"description","type":"string","description":"Business context/detail/memo.","nullable":true},{"name":"order","type":"int","description":"Sorting order for this entry among entries in a codebook.","nullable":false},{"name":"visible","type":"boolean","description":"Whether this entry is visible for business use.","nullable":false},{"name":"created_at","type":"datetime","description":"Created timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Updated timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp, if any.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_codebook_id","code"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_codebook_id","order"]}],"ginIndexes":[{"fieldName":"label"}]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"shopping_mall_ai_backend_customers","description":"Customer account information including all identity, authentication, and business lifecycle attributes. Serves as the base entity for all customer-centric commerce, holding references to profile, registration, and current status data. Supports independent user management, onboarding, and withdrawal requests. Linked to withdrawal and session event models.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","description":"Email address used for authentication and notifications. Must be unique per channel.","nullable":false},{"name":"phone_number","type":"string","description":"Customer's verified mobile phone number. Used for primary contact and regulatory identity check.","nullable":false},{"name":"password_hash","type":"string","description":"Hash of customer's authentication password. Never stored in cleartext.","nullable":false},{"name":"name","type":"string","description":"Full legal name of the customer as supplied or verified during onboarding.","nullable":false},{"name":"nickname","type":"string","description":"Customer's preferred display nickname. Displayed to sellers and in community features.","nullable":true},{"name":"is_active","type":"boolean","description":"Whether the customer account is currently active and enabled for login.","nullable":false},{"name":"is_verified","type":"boolean","description":"Whether real-name and/or mobile number identity verification is completed.","nullable":false},{"name":"last_login_at","type":"datetime","description":"Timestamp of the customer's most recent valid login. Useful for activity tracking and account monitoring.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the customer account was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the customer account record was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp recording logical deletion (withdrawal or admin removal) for compliance.","nullable":true}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true},{"fieldNames":["phone_number"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["is_active","is_verified"]}],"ginIndexes":[{"fieldName":"nickname"},{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_customer_withdrawals","description":"Historical log of customer withdrawal and account deactivation events, preserving evidence and regulatory compliance data. Each record acts as a snapshot of the state and rationale when the customer initiated or completed withdrawal.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"reason","type":"string","description":"Customer provided reason for withdrawal or deactivation.","nullable":true},{"name":"withdrawn_at","type":"datetime","description":"Timestamp when withdrawal/deactivation was completed.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of record creation for evidence.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["customer_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_customer_sessions","description":"Tracks all active or historical customer session records, used for authentication, fraud investigation, and multi-device login support. Manages session tokens, IP, device, and expiration for each authenticated interaction.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"access_token","type":"string","description":"Session's access token for API authentication.","nullable":false},{"name":"refresh_token","type":"string","description":"Token used to renew the session without re-authentication.","nullable":true},{"name":"ip_address","type":"string","description":"IP address from which the session originated.","nullable":false},{"name":"user_agent","type":"string","description":"Browser or device user agent string for context and fraud monitoring.","nullable":false},{"name":"expires_at","type":"datetime","description":"Session expiry datetime (based on system policy).","nullable":false},{"name":"created_at","type":"datetime","description":"Session creation timestamp.","nullable":false},{"name":"terminated_at","type":"datetime","description":"Timestamp of explicit session logout or forced termination.","nullable":true}],"uniqueIndexes":[{"fieldNames":["access_token"],"unique":true}],"plainIndexes":[{"fieldNames":["customer_id"]},{"fieldNames":["expires_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_customer_external_identities","description":"Links customer accounts to external identity providers such as OAuth/Social logins. Enables SSO, mapping, and external account management, ensuring business audit trail for all mappings.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"provider","type":"string","description":"External identity provider name (e.g., google, apple, naver, kakao).","nullable":false},{"name":"provider_key","type":"string","description":"Unique external key/id provided by the external provider for this customer.","nullable":false},{"name":"linked_at","type":"datetime","description":"Timestamp when this identity mapping was created.","nullable":false},{"name":"last_verified_at","type":"datetime","description":"Timestamp of last verified sign-in with this external provider.","nullable":true}],"uniqueIndexes":[{"fieldNames":["provider","provider_key"],"unique":true}],"plainIndexes":[{"fieldNames":["customer_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_sellers","description":"Seller (merchant) account entity, representing approved business users authorized to register, sell, and fulfill orders. Stores identity verification, business credentials, and current seller status. Independent management, onboarding, and compliance attributes are maintained per seller.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","description":"Seller's primary business email address used for registration and notifications. Unique per seller.","nullable":false},{"name":"business_registration_number","type":"string","description":"Seller's registered business identifier (regional/country standard number).","nullable":false},{"name":"name","type":"string","description":"Legal business name of seller (business entity).","nullable":false},{"name":"is_verified","type":"boolean","description":"Whether seller identity/business verification is complete and approved.","nullable":false},{"name":"is_active","type":"boolean","description":"Whether seller account is currently active and able to operate.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the seller account was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the seller account was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp (for closed or withdrawn sellers).","nullable":true}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true},{"fieldNames":["business_registration_number"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_seller_verifications","description":"Certification, KYB/KYC evidence and verification records related to seller onboarding or periodic compliance checks. Each record links to a seller and includes validation documents, scope, and approval outcomes. Managed only as per business policy and immutable history.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"seller_id","type":"uuid","description":"Belonged seller's {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":false}],"plainFields":[{"name":"verification_type","type":"string","description":"Type of business verification (e.g., identity, business_license, bank_account, AML, KYC).","nullable":false},{"name":"status","type":"string","description":"Current status (submitted, approved, rejected, expired, pending). Reflects compliance policy workflow.","nullable":false},{"name":"document_uri","type":"uri","description":"Secure URI to evidence document or file. Points to uploaded file or reference directory.","nullable":false},{"name":"submitted_at","type":"datetime","description":"Timestamp when verification document was submitted.","nullable":false},{"name":"verified_at","type":"datetime","description":"Timestamp when verification was approved (if successful).","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["seller_id"]},{"fieldNames":["status"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_seller_profiles","description":"Additional seller/business profile details, linked 1:1 to sellers. Includes optional and extended info, business contact, and public display settings. Managed through seller profile UI or admin.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"seller_id","type":"uuid","description":"Belonged seller's {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":true,"nullable":false}],"plainFields":[{"name":"display_name","type":"string","description":"Seller's public display name/brand (may be different from legal name).","nullable":true},{"name":"contact_phone","type":"string","description":"Primary contact phone for business operations.","nullable":true},{"name":"contact_email","type":"string","description":"Business or support contact email.","nullable":true},{"name":"address","type":"string","description":"Business registered address (for display or compliance use).","nullable":true},{"name":"description","type":"string","description":"Self-description or introductory text for the seller shop page.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the profile was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Profile update timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["seller_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"display_name"}]},{"name":"shopping_mall_ai_backend_seller_settlements","description":"Records of settlement configuration and payout instructions for each seller, used in financial processing and disbursement. Includes payout method, bank details, and account/recipient info per seller. Supports settlement changes and audit trail.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"seller_id","type":"uuid","description":"Belonged seller's {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":true,"nullable":false}],"plainFields":[{"name":"bank_name","type":"string","description":"Bank or financial institution name for disbursement.","nullable":false},{"name":"bank_account_number","type":"string","description":"Account number for payout.","nullable":false},{"name":"account_holder","type":"string","description":"Name of the registered account holder for settlements.","nullable":false},{"name":"remittance_memo","type":"string","description":"Optional memo or note field for settlement purposes.","nullable":true},{"name":"created_at","type":"datetime","description":"Settlement configuration creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to settlement info.","nullable":false}],"uniqueIndexes":[{"fieldNames":["seller_id"],"unique":true}],"plainIndexes":[{"fieldNames":["bank_account_number"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_admins","description":"Administrator account for platform operators, regulatory personnel, and business rule enforcement. Each admin manages business policies, audits, and incidents. Supports multi-factor auth, credential lifecycle, and status management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"username","type":"string","description":"Unique admin username or operator ID (must be unique).","nullable":false},{"name":"password_hash","type":"string","description":"Hashed administrator password for auth, never stored as cleartext.","nullable":false},{"name":"name","type":"string","description":"Administrator's real name for traceability.","nullable":false},{"name":"email","type":"string","description":"Administrator business email address (unique per admin).","nullable":false},{"name":"phone_number","type":"string","description":"Verified contact for admin (SMS/phone notification, account recovery).","nullable":true},{"name":"is_active","type":"boolean","description":"Whether this admin account is currently enabled.","nullable":false},{"name":"last_login_at","type":"datetime","description":"Time of last successful login. Used for audit trail and activity monitoring.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp of admin account creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last admin record update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp (retained for audit compliance).","nullable":true}],"uniqueIndexes":[{"fieldNames":["username"],"unique":true},{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_admin_audit_logs","description":"Business and system audit log of all privileged admin actions. Captures admin reference, operation performed, rationale, and affected target/count. Immutable record for compliance and forensic review by regulators.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"admin_id","type":"uuid","description":"Admin account's {@link shopping_mall_ai_backend_admins.id}.","relation":{"name":"admin","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":false}],"plainFields":[{"name":"operation","type":"string","description":"Type of privileged operation (e.g., approve_seller, suspend_user, modify_config, access_evidence).","nullable":false},{"name":"target_id","type":"uuid","description":"Primary identifier of the entity affected by this operation (for audit linkage).","nullable":false},{"name":"target_type","type":"string","description":"Type of entity affected (e.g., customer, seller, system, order, config).","nullable":false},{"name":"description","type":"string","description":"Detailed description or justification for the operation.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the audit log entry was created.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["admin_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"description"}]},{"name":"shopping_mall_ai_backend_role_escalations","description":"Snapshot entity capturing user membership/seller/admin role change and escalation events. Used for regulatory audit, approval workflows, and business process replays. Each record describes role transition, outcome, and rationale, with references to relevant user/admin.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"user_id","type":"uuid","description":"ID of the user whose role was escalated/deescalated (references customer, seller, or admin - cross-reference by context).","relation":{"name":"user","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false},{"name":"admin_id","type":"uuid","description":"Administrator who approved/escalated role (references {@link shopping_mall_ai_backend_admins.id}).","relation":{"name":"admin","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"from_role","type":"string","description":"Previous business role (e.g., customer, seller, admin, suspended, guest).","nullable":false},{"name":"to_role","type":"string","description":"Resulting business role after escalation/transition.","nullable":false},{"name":"escalation_type","type":"string","description":"Type of change (e.g., promotion, demotion, temporary, permanent, approval, rejection).","nullable":false},{"name":"reason","type":"string","description":"Optional human-readable rationale or system justification for the escalation.","nullable":true},{"name":"created_at","type":"datetime","description":"Time the escalation event was recorded.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["user_id"]},{"fieldNames":["admin_id"]}],"ginIndexes":[]}]},{"filename":"schema-03-products.prisma","namespace":"Products","models":[{"name":"shopping_mall_ai_backend_products","description":"Core product entity representing individual commerce items. Contains business attributes such as title, slug, description, seller reference, commerce status, minimum and maximum order amounts, product type, and additional configurations. Every update to this entity must be snapshotted to support audit and rollback. Linked via foreign keys to seller entities, and by extensions to options, bundles, categories, tags, and files. This table is essential for search, browse, and transaction eligibility decisions.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"title","type":"string","description":"Product title/name displayed to users, unique per seller and channel context.","nullable":false},{"name":"slug","type":"string","description":"SEO-friendly product slug, unique per channel and seller context.","nullable":false},{"name":"description","type":"string","description":"Detailed product description and content body.","nullable":true},{"name":"product_type","type":"string","description":"Type of product (e.g., physical, digital, service). Guides fulfillment and inventory logic.","nullable":false},{"name":"business_status","type":"string","description":"Current commerce status (e.g., draft, active, paused, restricted, deleted). Drives order eligibility and visibility.","nullable":false},{"name":"min_order_quantity","type":"int","description":"Minimum orderable quantity for a valid purchase.","nullable":false},{"name":"max_order_quantity","type":"int","description":"Maximum orderable quantity per transaction.","nullable":false},{"name":"tax_code","type":"string","description":"Applicable tax code category used for compliance and reporting.","nullable":false},{"name":"sort_priority","type":"int","description":"Manual or computed sort priority for product listings.","nullable":false},{"name":"created_at","type":"datetime","description":"UTC timestamp when product was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"UTC timestamp when product was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp when product was logically deleted. Null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["slug"],"unique":true}],"plainIndexes":[{"fieldNames":["product_type"]},{"fieldNames":["business_status"]},{"fieldNames":["tax_code"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"description"}]},{"name":"shopping_mall_ai_backend_product_options","description":"Product option groups (e.g., color, size) that define available choices per product. Each option group belongs to a product, provides business logic for required/optional/combination selection, and is versioned for audit. Directly linked to units for physical SKUs or attributes. Managed by sellers/admins in the product management flow.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_products_id","type":"uuid","description":"Belonged product's {@link shopping_mall_ai_backend_products.id}","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"option_name","type":"string","description":"Label for option group (e.g., color, size).","nullable":false},{"name":"required","type":"boolean","description":"Whether option selection is required for order eligibility.","nullable":false},{"name":"sort_order","type":"int","description":"Display order of this option group among product options.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when this option group was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when this option group was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for this option group. Null if active.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_products_id","option_name"]}],"ginIndexes":[{"fieldName":"option_name"}]},{"name":"shopping_mall_ai_backend_product_option_units","description":"Concrete selectable unit (e.g., Red, XL) within an option group for a product. Each unit belongs to a product option, contains value and code (for business rules/mapping), and has associated sort/display order. SKU inventory is typically tracked at this or a bundled level. Used in detailed order and inventory logic.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_product_options_id","type":"uuid","description":"Option group {@link shopping_mall_ai_backend_product_options.id} this unit belongs to.","relation":{"name":"option","targetModel":"shopping_mall_ai_backend_product_options"},"unique":false,"nullable":false}],"plainFields":[{"name":"unit_value","type":"string","description":"Display value for this selectable unit (e.g., Red, XL).","nullable":false},{"name":"unit_code","type":"string","description":"Machine-readable code for business logic, analytics.","nullable":false},{"name":"sort_order","type":"int","description":"Display order for selectable units within option group.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp of this unit.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last updated timestamp of this unit.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. Null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_product_options_id","unit_code"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"unit_value"}]},{"name":"shopping_mall_ai_backend_product_bundles","description":"Logical grouping of product option units, representing specific item variants (e.g., [Red, Large] bundle = unique SKU). Bundles can be used for package deals or unique SKUs with associated inventory/price. Each bundle is mapped to option units, owned by the parent product.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_products_id","type":"uuid","description":"Product owning the bundle. {@link shopping_mall_ai_backend_products.id}","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"bundle_name","type":"string","description":"Display name for this bundle/variant combination.","nullable":false},{"name":"sku_code","type":"string","description":"Unique code representing this bundle/SKU.","nullable":false},{"name":"price","type":"double","description":"Price for this bundle (could override product base price).","nullable":false},{"name":"inventory_policy","type":"string","description":"Inventory control logic (e.g., track, ignore, by parent config).","nullable":false},{"name":"is_active","type":"boolean","description":"Whether this bundle is available for sale.","nullable":false},{"name":"created_at","type":"datetime","description":"Bundle creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for bundle.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deaetion timestamp; null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["sku_code"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"bundle_name"}]},{"name":"shopping_mall_ai_backend_product_tags","description":"Tag master for products. Tags provide user-searchable, vendor-assigned, and/or AI-suggested semantic attributes for categorizing and filtering products (e.g., 'eco-friendly', 'new arrival'). Tags can be mapped to products many-to-many via relation tables or extensions.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"tag_name","type":"string","description":"Business-visible tag (label/content) for product filtering/search.","nullable":false},{"name":"tag_code","type":"string","description":"Machine-assigned code for business logic, search optimization, and analytics.","nullable":false},{"name":"created_at","type":"datetime","description":"Tag creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Tag deletion timestamp; null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tag_code"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"tag_name"}]},{"name":"shopping_mall_ai_backend_product_categories","description":"Product category master holds the hierarchical definition of product categories (e.g., Electronics > Computers > Laptops). Used for navigation, search, and data analytics. Every product can belong to multiple categories via mapping table.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"category_name","type":"string","description":"Display name of this category.","nullable":false},{"name":"category_code","type":"string","description":"Unique code for machine lookup, search, analytics.","nullable":false},{"name":"parent_id","type":"uuid","description":"Indicates parent category for category tree; null if top level.","nullable":true},{"name":"category_depth","type":"int","description":"Depth of this category in hierarchy (root = 0).","nullable":false},{"name":"is_active","type":"boolean","description":"Is category shown to users in navigation, search, etc.","nullable":false},{"name":"sort_order","type":"int","description":"Order among sibling categories for display.","nullable":false},{"name":"created_at","type":"datetime","description":"Category creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last modified timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"If deleted, deletion time, or null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["category_code"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"category_name"}]},{"name":"shopping_mall_ai_backend_product_category_mappings","description":"Junction table mapping products to categories (many-to-many). Each row represents one product-category association, used for navigation, filtering, and analytics. Enforces unique (product_id, category_id) constraint to prevent duplicates. Not managed independently from products/categories.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_products_id","type":"uuid","description":"Product reference. {@link shopping_mall_ai_backend_products.id}","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_product_categories_id","type":"uuid","description":"Category reference. {@link shopping_mall_ai_backend_product_categories.id}","relation":{"name":"category","targetModel":"shopping_mall_ai_backend_product_categories"},"unique":false,"nullable":false}],"plainFields":[{"name":"assigned_at","type":"datetime","description":"Timestamp when product-category mapping was created.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_products_id","shopping_mall_ai_backend_product_categories_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_product_files","description":"Files and images attached to products for presentation (main image, thumbnails, downloadable files). Stores metadata for display (file type, uploader, order) and references file storage for content resolution. Files may be managed by admins or sellers depending on product origin.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_products_id","type":"uuid","description":"Referenced product. {@link shopping_mall_ai_backend_products.id}","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"file_uri","type":"uri","description":"Storage URI or CDN link for file/image.","nullable":false},{"name":"file_type","type":"string","description":"Content type (e.g. image/jpeg, application/pdf).","nullable":false},{"name":"display_order","type":"int","description":"Order among product files -- determines display priority.","nullable":false},{"name":"is_primary","type":"boolean","description":"Is this file the primary display image?","nullable":false},{"name":"created_at","type":"datetime","description":"Attachment creation timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"If deleted, timestamp; null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["file_uri"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_product_snapshots","description":"Immutable historical record for point-in-time product state. Each snapshot references its original product and contains a full copy of all relevant product fields and relations at creation time. Used for audit compliance, evidence in disputes, and rollback. Snapshots are managed only via versioning logic and are never updated after creation.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_products_id","type":"uuid","description":"Product record this snapshot covers. {@link shopping_mall_ai_backend_products.id}","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"snapshot_index","type":"int","description":"Sequence number or revision index for versioning.","nullable":false},{"name":"snapshot_content","type":"string","description":"Serialized JSON or business object containing historical data for audit.","nullable":false},{"name":"snapshot_reason","type":"string","description":"Business reason or trigger for snapshot (manual update, system, correction, rollback, etc.).","nullable":false},{"name":"created_at","type":"datetime","description":"Time when snapshot was created.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_product_inventories","description":"Tracks stock level for products or bundles. Each record references a product or bundle, shows available quantity, reserved quantity, and last movement time. Provides base view for inventory tracking, order commitment, and business analysis. May point to either product or bundle as needed by business logic (union handled at application tier). Not independently managed by end users.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_products_id","type":"uuid","description":"Product this inventory is linked to. {@link shopping_mall_ai_backend_products.id}","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"available_quantity","type":"int","description":"Units available for sale (not reserved/committed).","nullable":false},{"name":"reserved_quantity","type":"int","description":"Committed units pending order completion.","nullable":false},{"name":"last_update_at","type":"datetime","description":"Time of the most recent stock movement (in/out/adjust).","nullable":false},{"name":"inventory_status","type":"string","description":"Business status of inventory (e.g., in_stock, out_of_stock, reserved, discontinued).","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["inventory_status"]}],"ginIndexes":[]}]},{"filename":"schema-04-carts.prisma","namespace":"Carts","models":[{"name":"shopping_mall_ai_backend_carts","description":"Represents the customer's shopping cart for any active session or channel (guest/member/linked session). Tracks current cart status, associated customer/session reference, and captures any detailed cart-note, coupon, mileage, or deposit status in real time. Critical as mutable pre-order record but uniquely preserved through immutable snapshots for audit/evidence. Users manage, merge, or clear carts independently per channel/session context. Supports omnichannel transfer.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Linked customer's {@link shopping_mall_ai_backend_customers.id}. Null for guest, required for member.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_customer_session_id","type":"uuid","description":"Current active session's {@link shopping_mall_ai_backend_customer_sessions.id}. Null if persistent cart not linked to a specific session.","relation":{"name":"customerSession","targetModel":"shopping_mall_ai_backend_customer_sessions"},"unique":false,"nullable":true}],"plainFields":[{"name":"cart_token","type":"string","description":"Opaque unique ID for cart. Used to re-link carts across devices or for guest workflows.","nullable":false},{"name":"status","type":"string","description":"Cart lifecycle status (e.g. active, submitted, merged, cleared, abandoned).","nullable":false},{"name":"expires_at","type":"datetime","description":"Cart expiration datetime (for auto-clear, guest, or session rules).","nullable":true},{"name":"last_merged_at","type":"datetime","description":"Datetime this cart was last merged with another cart (for omnichannel workflows).","nullable":true},{"name":"note","type":"string","description":"Customer's or business's cart note, instruction, or memo. Searchable field.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for evidence trail.","nullable":true}],"uniqueIndexes":[{"fieldNames":["cart_token"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"]},{"fieldNames":["status"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"note"}]},{"name":"shopping_mall_ai_backend_cart_items","description":"Individual and option-specific product items in a cart. Each record holds selection quantity, attached options, and referential snapshot pointer. Required for precise item, bundle, and variant management prior to checkout. Editable by the user per cart context. Historical traces and adjustments are preserved through linked snapshots.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_cart_id","type":"uuid","description":"Parent cart's {@link shopping_mall_ai_backend_carts.id}.","relation":{"name":"cart","targetModel":"shopping_mall_ai_backend_carts"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_product_snapshot_id","type":"uuid","description":"Product snapshot's {@link shopping_mall_ai_backend_product_snapshots.id} for price, title, attributes at time of add-to-cart.","relation":{"name":"productSnapshot","targetModel":"shopping_mall_ai_backend_product_snapshots"},"unique":false,"nullable":false}],"plainFields":[{"name":"quantity","type":"int","description":"Quantity for this item (minimum 1 per business policy).","nullable":false},{"name":"option_code","type":"string","description":"Aggregate code for option/variant selection (from product option units, enables unique constraint for per-product/item options).","nullable":false},{"name":"bundle_code","type":"string","description":"Product bundle code if selected (nullable if not used).","nullable":true},{"name":"note","type":"string","description":"Customer's note for this cart item (e.g. gift, details). Searchable field.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_cart_id","shopping_mall_ai_backend_product_snapshot_id","option_code","bundle_code"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_cart_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"note"}]},{"name":"shopping_mall_ai_backend_cart_item_snapshots","description":"Immutable snapshot of all cart item details at each add/edit/remove event, for business evidence and audit. Stores all relevant business fields, referential link to both original cart item and snapshot data, and a timestamp of when the snapshot was recorded. Ensures evidence preservation if cart or item is later edited or deleted.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_cart_item_id","type":"uuid","description":"Cart item's {@link shopping_mall_ai_backend_cart_items.id} being snapshotted.","relation":{"name":"cartItem","targetModel":"shopping_mall_ai_backend_cart_items"},"unique":false,"nullable":false}],"plainFields":[{"name":"snapshot_data","type":"string","description":"Serialized (JSON/text) snapshot of all cart item business fields for precise historical evidence. Not for query logic.","nullable":false},{"name":"reason","type":"string","description":"Snapshot creation reason (add, update, remove, merge, manual, evidence, etc).","nullable":false},{"name":"created_at","type":"datetime","description":"Snapshot creation timestamp.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_cart_item_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_cart_coupon_usages","description":"Per-cart usage log for all applied coupons, including time of application, validation status, and associated business rules. Tied to cart (not global basket) to ensure compliance with coupon stacking, exclusivity, order, eligibility, and evidence trace. May have more than one per cart, depending on business constraints.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_cart_id","type":"uuid","description":"Applied on related cart's {@link shopping_mall_ai_backend_carts.id}.","relation":{"name":"cart","targetModel":"shopping_mall_ai_backend_carts"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Applied coupon's {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons"},"unique":false,"nullable":false}],"plainFields":[{"name":"applied_at","type":"datetime","description":"Datetime coupon was applied to this cart.","nullable":false},{"name":"status","type":"string","description":"Current validation/application status (active, locked, rejected, used, etc.)","nullable":false},{"name":"stack_group","type":"string","description":"Label for stacking logic group (if stacking/exclusivity policy applies).","nullable":true},{"name":"note","type":"string","description":"Admin/business note for coupon usage.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_cart_id"]},{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["applied_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_cart_mileage_usages","description":"Cart-level historical log of all mileage (point) accrual or consumption events tied to this cart, including validation, redemption, and evidence of application. Subsidiary to the cart, but required for audit and compliance (e.g., only redeemable once per line, balance checks). All business constraints logged; supports composite queries for fraud or reward optimization.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_cart_id","type":"uuid","description":"Applied on related cart's {@link shopping_mall_ai_backend_carts.id}.","relation":{"name":"cart","targetModel":"shopping_mall_ai_backend_carts"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_mileage_id","type":"uuid","description":"Linked mileage balance's {@link shopping_mall_ai_backend_mileages.id}.","relation":{"name":"mileage","targetModel":"shopping_mall_ai_backend_mileages"},"unique":false,"nullable":false}],"plainFields":[{"name":"used_amount","type":"double","description":"Mileage (points) used or accrued. Negative for redemption, positive for accrual.","nullable":false},{"name":"reason","type":"string","description":"Business reason for mileage usage or accrual (e.g., redeem, bonus, policy).","nullable":false},{"name":"applied_at","type":"datetime","description":"Datetime of usage/accrual event.","nullable":false},{"name":"note","type":"string","description":"Admin/business note for this transaction.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_cart_id"]},{"fieldNames":["applied_at"]}],"ginIndexes":[]}]},{"filename":"schema-05-orders.prisma","namespace":"Orders","models":[{"name":"shopping_mall_ai_backend_orders","description":"Core entity representing the customer's commercial transaction. Records all business events and status changes in an order lifecycle, including references to the customer, channel, and seller. Enforces regulatory and audit constraints. Supports evidence preservation and compliance investigation. Designed for independent creation, search, and legal traceability.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_channel_id","type":"uuid","description":"Order's channel {@link shopping_mall_ai_backend_channels.id}.","relation":{"name":"channel","targetModel":"shopping_mall_ai_backend_channels"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Order's seller {@link shopping_mall_ai_backend_sellers.id}. May be nullable if not routed/split yet.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"code","type":"string","description":"Business order number (unique per channel, for external and customer reference).","nullable":false},{"name":"status","type":"string","description":"Business state/code for the current order (e.g. pending, confirmed, paid, shipped, delivered, cancelled, etc.).","nullable":false},{"name":"total_amount","type":"double","description":"Total amount of the order (final charge after all discounts and adjustments).","nullable":false},{"name":"currency","type":"string","description":"Order currency (ISO 4217, e.g. KRW, USD, JPY).","nullable":false},{"name":"ordered_at","type":"datetime","description":"Timestamp the order was submitted by the customer or created via an upstream channel.","nullable":false},{"name":"confirmed_at","type":"datetime","description":"Timestamp the order was business-confirmed (assigns stock and locks payment intent).","nullable":true},{"name":"cancelled_at","type":"datetime","description":"Timestamp if/when the order was cancelled, by user or operator.","nullable":true},{"name":"closed_at","type":"datetime","description":"Timestamp when the order was finalized (delivered, refunded, etc.).","nullable":true},{"name":"created_at","type":"datetime","description":"System record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"System record update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp. Null if record is active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code","shopping_mall_ai_backend_channel_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id","created_at"]},{"fieldNames":["shopping_mall_ai_backend_channel_id","created_at"]},{"fieldNames":["status","created_at"]}],"ginIndexes":[{"fieldName":"code"}]},{"name":"shopping_mall_ai_backend_order_items","description":"Line items for individual products/options within an order. Supports bundles, variants, quantity, and per-item price/discount. Managed only in context of an order. No direct API/CRUD, but required for evidence and fulfillment traceability.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_product_id","type":"uuid","description":"Purchased product's {@link shopping_mall_ai_backend_products.id}.","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_product_option_id","type":"uuid","description":"Selected option's {@link shopping_mall_ai_backend_product_options.id}.","relation":{"name":"productOption","targetModel":"shopping_mall_ai_backend_product_options"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_product_bundle_id","type":"uuid","description":"If bundled, the bundle's {@link shopping_mall_ai_backend_product_bundles.id}.","relation":{"name":"productBundle","targetModel":"shopping_mall_ai_backend_product_bundles"},"unique":false,"nullable":true}],"plainFields":[{"name":"product_title","type":"string","description":"Denormalized copy of product title at time of order (evidence, compliance).","nullable":false},{"name":"quantity","type":"int","description":"Ordered quantity for this line item.","nullable":false},{"name":"unit_price","type":"double","description":"Unit price at time of order (pre-discount).","nullable":false},{"name":"discount_amount","type":"double","description":"Discount applied to this line (may be 0).","nullable":false},{"name":"final_amount","type":"double","description":"Final charge for this line (unit * qty - discounts).","nullable":false},{"name":"currency","type":"string","description":"Currency code for item charge.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp. Null if record is active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id"]}],"ginIndexes":[{"fieldName":"product_title"}]},{"name":"shopping_mall_ai_backend_order_item_snapshots","description":"Historical snapshot versions of order items. Tracks changes to items (e.g. price correction, option change, after-sale) for full audit trail and evidence purposes. Append-only, not user-editable. Used for dispute resolution and compliance reporting.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_item_id","type":"uuid","description":"The original order item's {@link shopping_mall_ai_backend_order_items.id}.","relation":{"name":"orderItem","targetModel":"shopping_mall_ai_backend_order_items"},"unique":false,"nullable":false}],"plainFields":[{"name":"snapshot_reason","type":"string","description":"Business reason/context for the snapshot (e.g. after-sales edit, price change).","nullable":false},{"name":"quantity","type":"int","description":"Snapshot of ordered quantity at this version.","nullable":false},{"name":"unit_price","type":"double","description":"Snapshot unit price at this version.","nullable":false},{"name":"discount_amount","type":"double","description":"Snapshot discount value at this version.","nullable":false},{"name":"final_amount","type":"double","description":"Snapshot final value at this version.","nullable":false},{"name":"created_at","type":"datetime","description":"Snapshot creation timestamp (versioned history).","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_item_id","created_at"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_payments","description":"Tracks all payment attempts and records associated with an order. Supports multiple payment methods and split/partial charge scenarios. Used for audit, fraud detection, reconciliation, and compliance. Managed in context of the order; no direct creation by user.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Linked order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false}],"plainFields":[{"name":"payment_method","type":"string","description":"Business code for payment method (e.g. card, bank_transfer, deposit, mileage, coupon, etc).","nullable":false},{"name":"amount","type":"double","description":"Amount charged by this payment record.","nullable":false},{"name":"currency","type":"string","description":"Payment currency.","nullable":false},{"name":"status","type":"string","description":"Payment status (pending, succeeded, failed, refunded, etc).","nullable":false},{"name":"external_reference","type":"string","description":"External payment provider identifier (if any).","nullable":true},{"name":"requested_at","type":"datetime","description":"Payment requested timestamp.","nullable":false},{"name":"completed_at","type":"datetime","description":"Payment completed timestamp (if succeeded).","nullable":true},{"name":"failed_at","type":"datetime","description":"Payment failed timestamp, if any.","nullable":true},{"name":"cancelled_at","type":"datetime","description":"Payment cancellation timestamp.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for system logging.","nullable":false},{"name":"updated_at","type":"datetime","description":"Update timestamp for system logging.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","payment_method","external_reference"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","created_at"]},{"fieldNames":["status"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_payment_attempts","description":"Records every attempt to process payment (for retries, partial payments, failures, etc). Used from security, compliance, and business evidence perspectives. Append-only. Linked to specific order payment entries.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_payment_id","type":"uuid","description":"Parent payment's {@link shopping_mall_ai_backend_order_payments.id}.","relation":{"name":"orderPayment","targetModel":"shopping_mall_ai_backend_order_payments"},"unique":false,"nullable":false}],"plainFields":[{"name":"attempt_state","type":"string","description":"Payment attempt result code (pending, success, fail, retry, etc).","nullable":false},{"name":"error_message","type":"string","description":"Error message (if any failure or rejection occurred).","nullable":true},{"name":"provider_code","type":"string","description":"Payment provider code (if used).","nullable":true},{"name":"requested_at","type":"datetime","description":"Payment attempt timestamp (system clocked).","nullable":false},{"name":"completed_at","type":"datetime","description":"Attempt completion timestamp (if success/fail).","nullable":true},{"name":"created_at","type":"datetime","description":"System record creation time.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_payment_id","requested_at"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_payment_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_deliveries","description":"Represents single or partial physical delivery event(s) related to an order (e.g., split shipments, staggered delivery). Each links to the order header, with detail for tracking, status, and timeline. Fulfillment/logistics, not directly user-managed.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Parent order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false}],"plainFields":[{"name":"delivery_status","type":"string","description":"Delivery state (ready, in_progress, complete, failed, returned, etc).","nullable":false},{"name":"logistics_provider","type":"string","description":"Fulfillment carrier/partner code.","nullable":true},{"name":"tracking_number","type":"string","description":"Logistics carrier tracking ID.","nullable":true},{"name":"shipped_at","type":"datetime","description":"Datetime shipped or sent to carrier.","nullable":true},{"name":"delivered_at","type":"datetime","description":"Datetime completed by carrier (delivered, received).","nullable":true},{"name":"delivery_notes","type":"string","description":"Any user/business free-text notes about delivery.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","tracking_number"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id"]},{"fieldNames":["delivery_status"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_delivery_events","description":"Chronological event logs for all delivery status changes and logistics evidence for a shipment. Used for business traceability, customer service, and compliance. Append-only, one per discrete timeline event or external update.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_delivery_id","type":"uuid","description":"Parent delivery's {@link shopping_mall_ai_backend_order_deliveries.id}.","relation":{"name":"orderDelivery","targetModel":"shopping_mall_ai_backend_order_deliveries"},"unique":false,"nullable":false}],"plainFields":[{"name":"event_type","type":"string","description":"Event type (status update, exception, checkpoint, etc).","nullable":false},{"name":"event_context","type":"string","description":"Free-text event context for traceability/evidence.","nullable":true},{"name":"logged_at","type":"datetime","description":"Timestamp for the event.","nullable":false},{"name":"created_at","type":"datetime","description":"System creation timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_delivery_id","logged_at"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_delivery_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_returns","description":"Return requests/records for order items. Linked to orders and specific line-items. Manages business context (reason, status, evidence). Managed as after-sales action; used for refund/exchange workflows. Subsidiary table with compliance/audit focus.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Linked order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_order_item_id","type":"uuid","description":"Linked item's {@link shopping_mall_ai_backend_order_items.id}.","relation":{"name":"orderItem","targetModel":"shopping_mall_ai_backend_order_items"},"unique":false,"nullable":false}],"plainFields":[{"name":"return_reason","type":"string","description":"Reason provided by customer for return.","nullable":false},{"name":"status","type":"string","description":"Business logic status for the return process (requested, approved, rejected, completed).","nullable":false},{"name":"requested_at","type":"datetime","description":"Timestamp when return was requested.","nullable":false},{"name":"processed_at","type":"datetime","description":"Timestamp when processed (approved/rejected).","nullable":true},{"name":"completed_at","type":"datetime","description":"Return process completion timestamp.","nullable":true},{"name":"created_at","type":"datetime","description":"System creation date.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","shopping_mall_ai_backend_order_item_id"],"unique":true}],"plainIndexes":[{"fieldNames":["status","requested_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_exchanges","description":"Exchange process records for items/orders. Handles after-sales exchanges for eligible orders/items. Managed in context of original order/item. For compliance and traceability (subsidiary).","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Original order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_order_item_id","type":"uuid","description":"Original item's {@link shopping_mall_ai_backend_order_items.id}.","relation":{"name":"orderItem","targetModel":"shopping_mall_ai_backend_order_items"},"unique":false,"nullable":false}],"plainFields":[{"name":"exchange_reason","type":"string","description":"Reason provided for exchange.","nullable":false},{"name":"status","type":"string","description":"Current exchange process status (requested, approved, rejected, completed, etc).","nullable":false},{"name":"requested_at","type":"datetime","description":"Exchange requested timestamp.","nullable":false},{"name":"processed_at","type":"datetime","description":"Approval/rejection processed timestamp.","nullable":true},{"name":"completed_at","type":"datetime","description":"Exchange finalized timestamp.","nullable":true},{"name":"created_at","type":"datetime","description":"System create timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Update timestamp for record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","shopping_mall_ai_backend_order_item_id"],"unique":true}],"plainIndexes":[{"fieldNames":["status","requested_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_refunds","description":"Refund requests/records for orders or individual items. Supports full/partial, per-item or per-order refunds. Subsidiary with full business and audit context for compliance reporting. Managed by operator/admin or automated logic.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Linked order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false}],"plainFields":[{"name":"refund_reason","type":"string","description":"Reason for refund (e.g. customer request, system error, product issue).","nullable":false},{"name":"refund_type","type":"string","description":"Type of refund (full, partial, per-item, etc).","nullable":false},{"name":"amount","type":"double","description":"Amount refunded.","nullable":false},{"name":"currency","type":"string","description":"Currency of refund.","nullable":false},{"name":"status","type":"string","description":"Current status of the refund (requested, approved, rejected, paid, completed, etc).","nullable":false},{"name":"requested_at","type":"datetime","description":"Refund requested time.","nullable":false},{"name":"processed_at","type":"datetime","description":"Approval/rejection processing time.","nullable":true},{"name":"completed_at","type":"datetime","description":"Refund completion timestamp.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","requested_at"],"unique":true}],"plainIndexes":[{"fieldNames":["status","requested_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_order_incidents","description":"Tracks incidents, exceptions, or evidence logs tied to orders: e.g. fraud, user disputes, chargeback evidence, compliance events. Managed only by admin/operator actions; append-only for audit, legal, and business traceability.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Order's {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":false}],"plainFields":[{"name":"incident_type","type":"string","description":"Business code for incident type (fraud, dispute, system_error, compliance, evidence, etc).","nullable":false},{"name":"context","type":"string","description":"Free-text or structured JSON business context.","nullable":true},{"name":"event_at","type":"datetime","description":"When the incident/event occurred.","nullable":false},{"name":"created_at","type":"datetime","description":"System record created at.","nullable":false},{"name":"updated_at","type":"datetime","description":"Updated at for record changes.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_order_id","event_at","incident_type"],"unique":true}],"plainIndexes":[{"fieldNames":["incident_type","event_at"]}],"ginIndexes":[]}]},{"filename":"schema-06-coupons.prisma","namespace":"Coupons","models":[{"name":"shopping_mall_ai_backend_coupons","description":"Master list of all coupons, promotions, and discount policies including type, value, stacking, applicability, eligibility definitions, and meta-configuration. Cross-linked to issuances, codes, stacking, restrictions, notifications, and snapshots. Enables regulatory compliance, analytics, and personal or bulk issuance.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_channel_id","type":"uuid","description":"Scope of coupon for promotions within a specific channel. References {@link shopping_mall_ai_backend_channels.id}.","relation":{"name":"channel","targetModel":"shopping_mall_ai_backend_channels"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Seller that issued the coupon, if applicable. References {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"code","type":"string","description":"Unique business code for the coupon or promotion campaign. E.g. SUMMER2024, NEWUSER50.","nullable":false},{"name":"type","type":"string","description":"Coupon type: e.g., 'fixed', 'percentage', 'shipping', 'event', 'welcome', 'bulk_code', 'personal'. Should be validated in application or codebook.","nullable":false},{"name":"title","type":"string","description":"Title for human-recognition (e.g., '10% Off First Order').","nullable":false},{"name":"description","type":"string","description":"Detailed description for display and audit trails.","nullable":true},{"name":"value","type":"double","description":"Discount amount or percentage depending on type.","nullable":false},{"name":"min_order_amount","type":"double","description":"Minimum eligible order amount, if any, for use validation.","nullable":true},{"name":"max_discount_amount","type":"double","description":"Maximum discount that can be applied, for percentage or capped coupons.","nullable":true},{"name":"currency","type":"string","description":"Currency code if monetary. (e.g., 'KRW','USD'). Null for non-monetary coupons.","nullable":true},{"name":"expires_at","type":"datetime","description":"Coupon expiration datetime (absolute or computed per-issuance).","nullable":true},{"name":"stackable","type":"boolean","description":"Whether the coupon can stack with others (default: false). Business-level validation required for eligibility.","nullable":false},{"name":"personal","type":"boolean","description":"True if only for a specific customer (e.g., birthday, one-off, event, new-member).","nullable":false},{"name":"issued_quantity","type":"int","description":"Max issue count (e.g., for the entire campaign) or null for unlimited.","nullable":true},{"name":"issued_per_user","type":"int","description":"How many times a single user can be issued this coupon.","nullable":true},{"name":"used_per_user","type":"int","description":"Usage limit per user (null=unlimited).","nullable":true},{"name":"usage_limit_total","type":"int","description":"Total uses allowed for this coupon (null=unlimited).","nullable":true},{"name":"issued_count","type":"int","description":"Total number of coupons actually issued (system-maintained, for analytics).","nullable":false},{"name":"used_count","type":"int","description":"System-maintained: aggregate number of times this coupon was successfully used.","nullable":false},{"name":"published_at","type":"datetime","description":"When coupon is/will be publicly available for claim.","nullable":true},{"name":"status","type":"string","description":"Coupon status (e.g. 'active', 'expired', 'scheduled', 'hidden', 'restricted'). Validate in application or via codebooks.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-deletion timestamp if the coupon is removed from view.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code","shopping_mall_ai_backend_channel_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_channel_id"]},{"fieldNames":["shopping_mall_ai_backend_seller_id"]},{"fieldNames":["status"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"description"}]},{"name":"shopping_mall_ai_backend_coupon_issuances","description":"Instance of coupon issued to a customer or group. Tracks the allocation, recipient, status, and issuance time. Linked to coupons and customers, and references the underlying policy for regulatory and eligibility tracking.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Coupon policy associated with this issuance. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Customer recipient issued this coupon. {@link shopping_mall_ai_backend_customers.id}. Required if personal coupon.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true}],"plainFields":[{"name":"external_code","type":"string","description":"Redemption/external code assigned for this issuance (e.g. for affiliate, external campaigns).","nullable":true},{"name":"expires_at","type":"datetime","description":"Expiration for issued coupon (overrides policy-specific expiry, e.g., per-user duration).","nullable":true},{"name":"status","type":"string","description":"Status per issuance ('issued','used','revoked','expired'). Application-validated or codebook-based.","nullable":false},{"name":"issued_at","type":"datetime","description":"Issuance timestamp (when delivered/given to user).","nullable":false},{"name":"used_at","type":"datetime","description":"When coupon was actually redeemed (if used).","nullable":true},{"name":"revoked_at","type":"datetime","description":"When coupon was revoked (user withdrawal or policy violation).","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id","shopping_mall_ai_backend_customer_id","external_code"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["shopping_mall_ai_backend_customer_id"]},{"fieldNames":["status"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coupon_usages","description":"Coupon redemption log. Tracks each attempt or successful use of a coupon issuance (per customer, per order, per event). Linked to the issuance, the redeemed customer, and order. Allows auditing of coupon consumption and fraud tracking.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_issuance_id","type":"uuid","description":"References the coupon issuance being used. {@link shopping_mall_ai_backend_coupon_issuances.id}.","relation":{"name":"couponIssuance","targetModel":"shopping_mall_ai_backend_coupon_issuances"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Customer using coupon. Redundant to coupon_issuance.customer by history (audit reliability). {@link shopping_mall_ai_backend_customers.id} .","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_order_id","type":"uuid","description":"Order where coupon was used (for cross-reference/audit). {@link shopping_mall_ai_backend_orders.id}.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":true}],"plainFields":[{"name":"used_at","type":"datetime","description":"When this usage occurred (actual redemption).","nullable":false},{"name":"amount_discounted","type":"double","description":"Actual discount value given by this coupon on this usage (for refund, analytics).","nullable":false},{"name":"status","type":"string","description":"Usage status, e.g. 'success','failed','rolled_back'. Application-enforced for audit trail.","nullable":false},{"name":"rolledback_at","type":"datetime","description":"If usage was later revoked or refunded, time here indicates when event occurred (e.g., if refund or invalid).","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_issuance_id","shopping_mall_ai_backend_order_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"]},{"fieldNames":["used_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coupon_codes","description":"Table holding bulk coupon codes for campaigns (e.g., public events, external coupons). Maps each code to coupon policy and its status in issuance or redemption. Prevents code collisions, duplicate use, and supports external integrations.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Coupon this code belongs to. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_coupon_issuance_id","type":"uuid","description":"If issued as an individual allocation, link to the issuance. Useful for personalized or claimed codes. {@link shopping_mall_ai_backend_coupon_issuances.id}.","relation":{"name":"couponIssuance","targetModel":"shopping_mall_ai_backend_coupon_issuances"},"unique":false,"nullable":true}],"plainFields":[{"name":"bulk_code","type":"string","description":"Bulk/published coupon code. E.g., for codes handed out at event, on a flyer.","nullable":false},{"name":"issued_to_email","type":"string","description":"Optional: contact/email assigned for code claim (for invite/referral/event tracking).","nullable":true},{"name":"status","type":"string","description":"Status: 'available','issued','redeemed','invalidated','revoked'. Business-level enforcement.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp (code generation).","nullable":false},{"name":"redeemed_at","type":"datetime","description":"When code was actually redeemed (if applicable).","nullable":true},{"name":"revoked_at","type":"datetime","description":"If code invalidated/revoked, store timestamp.","nullable":true}],"uniqueIndexes":[{"fieldNames":["bulk_code"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["status"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coupon_stacking_rules","description":"Defines allowed/disallowed stacking of coupons and types, both in general and per coupon campaign. Explicitly structures business-restricted stackability (e.g., 'A cannot stack with B', 'fixed+percentage allowed', 'only 1 coupon per order'). Used in policy validation and at redemption.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Coupon for which this stacking rule applies. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons","mappingName":"shopping_mall_ai_backend_coupon_stacking_rules_of_shop_35b558e3"},"unique":false,"nullable":true},{"name":"excluded_coupon_id","type":"uuid","description":"Specific coupon or type (if any) that this coupon cannot stack with. Nullable for type/policy-wise rules. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"excludedCoupon","targetModel":"shopping_mall_ai_backend_coupons","mappingName":"shopping_mall_ai_backend_coupon_stacking_rules_of_excl_d38ba2b8"},"unique":false,"nullable":true}],"plainFields":[{"name":"type","type":"string","description":"Rule type: 'allow', 'deny', or 'override'. Business logic enforces actual stacking. Use codebook in application if possible.","nullable":false},{"name":"applies_to_type","type":"string","description":"Target coupon type/category this rule applies to (e.g., all 'fixed', 'shipping', etc.). Null if only per-coupon.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp of this stacking rule.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["excluded_coupon_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coupon_restrictions","description":"Per-coupon restriction definitions. Defines not-allowed conditions, periods, channels, users, sections, categories, products. Supports fine-grained business enforcement (e.g., 'not valid with product X', 'not for user group Y', 'blocked on weekends', etc.).","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Coupon to restrict. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_product_id","type":"uuid","description":"Product this restriction applies to (if any, else null means general/global). {@link shopping_mall_ai_backend_products.id}.","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_channel_section_id","type":"uuid","description":"Section limitation (if any). {@link shopping_mall_ai_backend_channel_sections.id}.","relation":{"name":"channelSection","targetModel":"shopping_mall_ai_backend_channel_sections"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_channel_category_id","type":"uuid","description":"Category limitation (if any). {@link shopping_mall_ai_backend_channel_categories.id}.","relation":{"name":"channelCategory","targetModel":"shopping_mall_ai_backend_channel_categories"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"User-level restriction (blacklist, group-exclude, business-group, etc.) {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true}],"plainFields":[{"name":"start_time","type":"datetime","description":"Restriction start (blocked during this time). Null for always-blocked.","nullable":true},{"name":"end_time","type":"datetime","description":"Restriction end (blocked until this time). Null for always-blocked.","nullable":true},{"name":"weekday_bitmask","type":"int","description":"Bitmask for restrict on specific days of the week (application logic required).","nullable":true},{"name":"is_holiday_restricted","type":"boolean","description":"Whether restriction also applies during holidays.","nullable":true},{"name":"reason_code","type":"string","description":"Code/reason for restriction (audit log, application validates).","nullable":true},{"name":"created_at","type":"datetime","description":"Created at.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["shopping_mall_ai_backend_product_id"]},{"fieldNames":["shopping_mall_ai_backend_channel_section_id"]},{"fieldNames":["shopping_mall_ai_backend_channel_category_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coupon_notifications","description":"Per-coupon, code, or issuance notification log/tracking for required or business-driven user notifications. Used for compliance, auditing, and evidence. Includes type, status, send time, result, error messages. Can log push, email, or SMS notifications.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Coupon policy to which the notification relates. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_coupon_issuance_id","type":"uuid","description":"Lower specificity: specific issuance for which notification event occurred (e.g., notification of redemption/expiry). {@link shopping_mall_ai_backend_coupon_issuances.id}.","relation":{"name":"couponIssuance","targetModel":"shopping_mall_ai_backend_coupon_issuances"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_coupon_code_id","type":"uuid","description":"Notification relates to a particular code within a campaign. {@link shopping_mall_ai_backend_coupon_codes.id}.","relation":{"name":"couponCode","targetModel":"shopping_mall_ai_backend_coupon_codes"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Customer target of notification. {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true}],"plainFields":[{"name":"notification_type","type":"string","description":"Type: e.g., 'issuance','expiry','reminder','redemption','admin','campaign','error'.","nullable":false},{"name":"status","type":"string","description":"Delivery status: 'pending','sent','failed','acknowledged'.","nullable":false},{"name":"send_attempts","type":"int","description":"Number of prior attempts.","nullable":false},{"name":"last_attempted_at","type":"datetime","description":"When last send was attempted (if any).","nullable":true},{"name":"result_message","type":"string","description":"Response/result/error info.","nullable":true},{"name":"created_at","type":"datetime","description":"Created at.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["shopping_mall_ai_backend_coupon_code_id"]},{"fieldNames":["status"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coupon_snapshots","description":"Immutable snapshots capturing full coupon policy state and related key attributes for audit and historical trace. Created whenever coupon is created or policy/rules are changed. Enables evidence for compliance and legal defense.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coupon_id","type":"uuid","description":"Original coupon this snapshot records. {@link shopping_mall_ai_backend_coupons.id}.","relation":{"name":"coupon","targetModel":"shopping_mall_ai_backend_coupons"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_admin_id","type":"uuid","description":"Admin who created/modified the policy and triggered the snapshot. {@link shopping_mall_ai_backend_admins.id}.","relation":{"name":"admin","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"policy_json","type":"string","description":"Serialized full snapshot of coupon policy and relations—must include all business attributes and major rules for evidence. JSON for maximum historical fidelity.","nullable":false},{"name":"created_at","type":"datetime","description":"Snapshot creation time.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coupon_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[]}]},{"filename":"schema-07-coins.prisma","namespace":"Coins","models":[{"name":"shopping_mall_ai_backend_deposits","description":"Represents the ledger of cash-like deposits for both customers and sellers. Tracks available balances, total accrued, and current state (e.g., usable, on hold, expired) for each account holder. Connects to detailed transaction and adjustment logs. Provides a core basis for refundable value holding and operational compliance. Related to {@link shopping_mall_ai_backend_deposit_transactions} and customer/seller tables.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_ai_backend_customers.id}. This field is used for customer deposit ledgers.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":true,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Belonged seller's {@link shopping_mall_ai_backend_sellers.id}. This field is used for seller deposit ledgers.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":true,"nullable":true}],"plainFields":[{"name":"total_accrued","type":"double","description":"Cumulative cash (or equivalent) amount ever credited, including expired/withdrawn funds.","nullable":false},{"name":"usable_balance","type":"double","description":"Current deposit balance available for use or withdrawal.","nullable":false},{"name":"expired_balance","type":"double","description":"Deposit value expired or lost and not available to user.","nullable":false},{"name":"on_hold_balance","type":"double","description":"Balance temporarily frozen due to withdrawal, incident, or review; not available for use.","nullable":false},{"name":"created_at","type":"datetime","description":"Ledger creation timestamp for audit and evidence.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last ledger update timestamp for audit and evidence.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"],"unique":true},{"fieldNames":["shopping_mall_ai_backend_seller_id"],"unique":true}],"plainIndexes":[{"fieldNames":["usable_balance"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_deposit_transactions","description":"Detailed log of all deposit changes including accrual, consumption, withdrawal, expiration, manual adjustments, and incident-related events. Ensures full auditability, enabling ledger reconciliation and business compliance. Each transaction references the linked ledger and user/seller, and keeps event context such as transaction type, reason, and audit trace.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_deposit_id","type":"uuid","description":"Reference to deposit ledger {@link shopping_mall_ai_backend_deposits.id}.","relation":{"name":"deposit","targetModel":"shopping_mall_ai_backend_deposits"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Linked customer {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Linked seller {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"change_type","type":"string","description":"Nature of transaction (e.g., accrual, usage, withdrawal, expire, reversal, manual_adjustment, incident_lock, incident_unlock, etc.).","nullable":false},{"name":"amount","type":"double","description":"Amount changed in this transaction (positive for accrual, negative for usage/expire).","nullable":false},{"name":"transaction_reference","type":"string","description":"External/internal reference code for audit/correlation (e.g., withdrawal req, order id, etc.).","nullable":true},{"name":"balance_before","type":"double","description":"Ledger balance immediately before this transaction.","nullable":false},{"name":"balance_after","type":"double","description":"Ledger balance after this transaction is applied.","nullable":false},{"name":"reason_code","type":"string","description":"Business reason or outcome code for analytics/compliance.","nullable":true},{"name":"description","type":"string","description":"Textual explanation/context for this transaction, for business review or compliance.","nullable":true},{"name":"created_at","type":"datetime","description":"Transaction creation timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if active.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_deposit_id","created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_mileages","description":"Mileage (points/reward) ledger for customers and sellers. Tracks overall accruals, usable and expired balances, segmented by account holder. Enables membership, promotional, and event point management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Customer who owns this mileage ledger. {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":true,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Seller who owns this mileage ledger. {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":true,"nullable":true}],"plainFields":[{"name":"total_accrued","type":"double","description":"Cumulative mileage/point credits (all-time) including expired/lost.","nullable":false},{"name":"usable_mileage","type":"double","description":"Current mileage balance available for use.","nullable":false},{"name":"expired_mileage","type":"double","description":"Mileage value expired or deleted and not available to user.","nullable":false},{"name":"on_hold_mileage","type":"double","description":"Mileage temporarily frozen due to incident, claim, fraud, etc.","nullable":false},{"name":"created_at","type":"datetime","description":"Ledger creation time for evidence/audit.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last ledger update time for evidence/audit.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"],"unique":true},{"fieldNames":["shopping_mall_ai_backend_seller_id"],"unique":true}],"plainIndexes":[{"fieldNames":["usable_mileage"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_mileage_transactions","description":"Audit log of all mileage (point) ledger modifications, including accruals, usage, expirations, manual/admin adjustments, and incident-driven events. Each record preserves ledger state change and rationale context.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_mileage_id","type":"uuid","description":"Associated mileage ledger {@link shopping_mall_ai_backend_mileages.id}.","relation":{"name":"mileage","targetModel":"shopping_mall_ai_backend_mileages"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Customer associated to this transaction. {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Seller associated to this transaction. {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"change_type","type":"string","description":"Action performed (e.g., accrual, use, expire, reversal, admin_adjust, incident_freeze, incident_release, donation, etc.).","nullable":false},{"name":"amount","type":"double","description":"Value changed in this transaction (positive for accrual, negative for usage/loss/expire).","nullable":false},{"name":"transaction_reference","type":"string","description":"Internal/external reference (order, refund, gift, campaign, etc.).","nullable":true},{"name":"mileage_before","type":"double","description":"Ledger balance before transaction.","nullable":false},{"name":"mileage_after","type":"double","description":"Ledger balance after transaction.","nullable":false},{"name":"reason_code","type":"string","description":"Business/process reason for audit analytics.","nullable":true},{"name":"description","type":"string","description":"Narrative for this specific transaction (for compliance or analytics).","nullable":true},{"name":"created_at","type":"datetime","description":"Transaction creation timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp, null if active.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_mileage_id","created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coins","description":"Digital coin ledger for both users and sellers. Tracks coin accrual, usage, on-hold coins, and expired/lost events. Often used for promotional, wallet, or special event non-fiat value operations.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Owner customer {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":true,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Owner seller {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":true,"nullable":true}],"plainFields":[{"name":"total_accrued","type":"double","description":"Sum of all coins ever granted/accrued (regardless of use or expiration).","nullable":false},{"name":"usable_coin","type":"double","description":"Currently available coin balance for the owner.","nullable":false},{"name":"expired_coin","type":"double","description":"Value of coins expired/unavailable to the user.","nullable":false},{"name":"on_hold_coin","type":"double","description":"Coin value temporarily unavailable due to withdrawal, dispute, or compliance.","nullable":false},{"name":"created_at","type":"datetime","description":"Ledger creation time for compliance/evidence.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for compliance/evidence.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"],"unique":true},{"fieldNames":["shopping_mall_ai_backend_seller_id"],"unique":true}],"plainIndexes":[{"fieldNames":["usable_coin"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_coin_transactions","description":"Comprehensive ledger audit entries for all coin changes, including accrual, expenditure, manual/admin adjustment, incident freeze/unfreeze, event distributions, and expiration. Tracks before/after coin values and process context for evidence.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_coin_id","type":"uuid","description":"Target coin ledger {@link shopping_mall_ai_backend_coins.id}.","relation":{"name":"coin","targetModel":"shopping_mall_ai_backend_coins"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Associated customer, nullable.{@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Associated seller, nullable.{@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"change_type","type":"string","description":"Event for this transaction (e.g., accrue, use, expire, reversal, admin_adjust, incident_hold, incident_release, etc.).","nullable":false},{"name":"amount","type":"double","description":"Value changed in this action (positive or negative by context).","nullable":false},{"name":"transaction_reference","type":"string","description":"Reference to related order, event, gift, etc.","nullable":true},{"name":"coin_before","type":"double","description":"Coin balance before this transaction.","nullable":false},{"name":"coin_after","type":"double","description":"Coin balance after transaction.","nullable":false},{"name":"reason_code","type":"string","description":"Process/business code for this event type.","nullable":true},{"name":"description","type":"string","description":"Business explanation for evidence/analytics.","nullable":true},{"name":"created_at","type":"datetime","description":"Transaction creation timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp, null if active.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_coin_id","created_at"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_financial_incidents","description":"Incident, anomaly, or audit/investigatory event log related to deposit, mileage, or coin ledgers. Captures all cases of suspected fraud, unauthorized usage, reversals, compliance freezes, or business-side ledger investigation. Ensures audit trail for financial events with business or legal impact.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_deposit_id","type":"uuid","description":"Related deposit ledger involved in this incident. Nullable if not deposit-linked. {@link shopping_mall_ai_backend_deposits.id}.","relation":{"name":"deposit","targetModel":"shopping_mall_ai_backend_deposits"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_mileage_id","type":"uuid","description":"Related mileage ledger involved in this incident. Nullable if not mileage-linked. {@link shopping_mall_ai_backend_mileages.id}.","relation":{"name":"mileage","targetModel":"shopping_mall_ai_backend_mileages"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_coin_id","type":"uuid","description":"Related coin ledger involved in this incident. Nullable if not coin-linked. {@link shopping_mall_ai_backend_coins.id}.","relation":{"name":"coin","targetModel":"shopping_mall_ai_backend_coins"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Associated customer if relevant. Nullable. {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"shopping_mall_ai_backend_seller_id","type":"uuid","description":"Associated seller if relevant. Nullable. {@link shopping_mall_ai_backend_sellers.id}.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"incident_type","type":"string","description":"Type/category of incident (e.g., fraud, reversal, compliance_audit, withdrawal_dispute, manual_freeze, system_error, anomaly_detection, etc.).","nullable":false},{"name":"status","type":"string","description":"Current status (open, investigating, closed, resolved, reversed, etc.).","nullable":false},{"name":"details","type":"string","description":"Narrative business/context details of this incident. For compliance and root cause review.","nullable":false},{"name":"external_reference","type":"string","description":"Correlator/reference to external systems, event logs, or legal/insurance process.","nullable":true},{"name":"created_at","type":"datetime","description":"Incident started/recorded timestamp.","nullable":false},{"name":"resolved_at","type":"datetime","description":"Resolution time if closed; null if still open/ongoing.","nullable":true},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if still valid.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["incident_type"]},{"fieldNames":["status"]}],"ginIndexes":[{"fieldName":"details"}]}]},{"filename":"schema-08-inquiries.prisma","namespace":"Inquiries","models":[{"name":"shopping_mall_ai_backend_inquiries","description":"Represents inquiries raised by customers or sellers about products, orders, deliveries, or general topics. Supports privacy level (public/private), ownership by customer or seller, ties to relevant product/order, visibility controls, and workflow status. Serves as the main entity for buyer-seller-admin engagement and evidence in dispute resolution. Snapshots and moderation logs reference this entity.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"customer_id","type":"uuid","description":"Inquiry owner's {@link shopping_mall_ai_backend_customers.id}. May be null for non-customer inquiries.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"seller_id","type":"uuid","description":"Inquiry owner's {@link shopping_mall_ai_backend_sellers.id}. Null for customer inquiries.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true},{"name":"product_id","type":"uuid","description":"Product related to the inquiry. {@link shopping_mall_ai_backend_products.id}. Nullable for non-product inquiries.","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":true},{"name":"order_id","type":"uuid","description":"Order related to the inquiry. {@link shopping_mall_ai_backend_orders.id}. Nullable for inquiries not about specific order.","relation":{"name":"order","targetModel":"shopping_mall_ai_backend_orders"},"unique":false,"nullable":true}],"plainFields":[{"name":"title","type":"string","description":"Inquiry subject or summary line.","nullable":false},{"name":"body","type":"string","description":"Full inquiry content, typically user question or statement.","nullable":false},{"name":"private","type":"boolean","description":"Whether the inquiry is private (visible only to owner and target) or public.","nullable":false},{"name":"status","type":"string","description":"Inquiry workflow status (e.g., open, answered, closed, pending_moderation, rejected).","nullable":false},{"name":"closed_at","type":"datetime","description":"Timestamp when inquiry was closed or resolved.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp this inquiry was authored.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to inquiry.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp when inquiry was marked deleted (soft delete), nullable.","nullable":true}],"uniqueIndexes":[{"fieldNames":["customer_id","seller_id","product_id","order_id","title","body","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["product_id","created_at"]},{"fieldNames":["order_id"]},{"fieldNames":["status","created_at"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"body"}]},{"name":"shopping_mall_ai_backend_inquiry_replies","description":"Represents threaded replies (answers, follow-ups, clarifications) to inquiries. Supports nested structure through parent_id self-reference, attribution to customer or seller, visibility (private/public), and evidence trails. Requires independent search and management across all inquiries.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"inquiry_id","type":"uuid","description":"Replied inquiry's {@link shopping_mall_ai_backend_inquiries.id}.","relation":{"name":"inquiry","targetModel":"shopping_mall_ai_backend_inquiries"},"unique":false,"nullable":false},{"name":"parent_id","type":"uuid","description":"Parent reply's {@link shopping_mall_ai_backend_inquiry_replies.id} for nested thread replies. Null for top-level.","relation":{"name":"parent","targetModel":"shopping_mall_ai_backend_inquiry_replies","mappingName":"recursive"},"unique":false,"nullable":true},{"name":"customer_id","type":"uuid","description":"Reply author's {@link shopping_mall_ai_backend_customers.id}. May be null for seller replies.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":true},{"name":"seller_id","type":"uuid","description":"Reply author's {@link shopping_mall_ai_backend_sellers.id}. Null for customer replies.","relation":{"name":"seller","targetModel":"shopping_mall_ai_backend_sellers"},"unique":false,"nullable":true}],"plainFields":[{"name":"body","type":"string","description":"Reply content.","nullable":false},{"name":"private","type":"boolean","description":"Whether the reply is private (visible only to owner and counterpart) or public.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when reply was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to reply.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp if reply was soft deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["inquiry_id","parent_id","body","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["inquiry_id","created_at"]}],"ginIndexes":[{"fieldName":"body"}]},{"name":"shopping_mall_ai_backend_inquiry_snapshots","description":"Captures immutable historical copies of inquiries and their replies for evidence, audit, and compliance. Each record represents a past state, generated on create, update, delete, or status change, and linked to the original entity. Crucial for dispute resolution and regulatory requirements.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"inquiry_id","type":"uuid","description":"Snapshot target inquiry's {@link shopping_mall_ai_backend_inquiries.id}.","relation":{"name":"inquiry","targetModel":"shopping_mall_ai_backend_inquiries"},"unique":false,"nullable":false},{"name":"reply_id","type":"uuid","description":"Snapshot target reply's {@link shopping_mall_ai_backend_inquiry_replies.id}, nullable if the snapshot is for the inquiry itself.","relation":{"name":"reply","targetModel":"shopping_mall_ai_backend_inquiry_replies"},"unique":false,"nullable":true}],"plainFields":[{"name":"title","type":"string","description":"(Resolved) inquiry title at time of snapshot.","nullable":true},{"name":"body","type":"string","description":"(Resolved) inquiry or reply body at time of snapshot.","nullable":true},{"name":"private","type":"boolean","description":"Privacy flag at time of snapshot.","nullable":true},{"name":"status","type":"string","description":"Status (open/closed/etc) at time of snapshot.","nullable":true},{"name":"closed_at","type":"datetime","description":"Closed at (if applicable) at snapshot point.","nullable":true},{"name":"author_type","type":"string","description":"Type of author (customer/seller/admin/system) at snapshot point.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when this snapshot was created.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["inquiry_id","created_at"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"body"}]},{"name":"shopping_mall_ai_backend_inquiry_abuse_reports","description":"Stores user-submitted abuse or violation reports against inquiries or replies. Includes linkage to reporting customer, to admin reviewer handling the report, timestamps, status, and references to the inquiry/reply in question. Enables abuse detection, moderation, and audit evidence.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"reporter_customer_id","type":"uuid","description":"Reporting individual's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"reporterCustomer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false},{"name":"inquiry_id","type":"uuid","description":"Subject inquiry's {@link shopping_mall_ai_backend_inquiries.id}.","relation":{"name":"inquiry","targetModel":"shopping_mall_ai_backend_inquiries"},"unique":false,"nullable":true},{"name":"reply_id","type":"uuid","description":"Subject reply's {@link shopping_mall_ai_backend_inquiry_replies.id}, nullable if abuse report is about inquiry only.","relation":{"name":"reply","targetModel":"shopping_mall_ai_backend_inquiry_replies"},"unique":false,"nullable":true},{"name":"admin_id","type":"uuid","description":"Admin reviewer assigned to handle this report. {@link shopping_mall_ai_backend_admins.id}.","relation":{"name":"admin","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"reason","type":"string","description":"Report details provided by reporter (freeform).","nullable":false},{"name":"status","type":"string","description":"Report workflow status (open, under_review, resolved, rejected, closed).","nullable":false},{"name":"closed_at","type":"datetime","description":"Closure timestamp for resolved/closed reports.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when report was submitted.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when report was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Timestamp of report deletion (nullable).","nullable":true}],"uniqueIndexes":[{"fieldNames":["reporter_customer_id","inquiry_id","reply_id","reason","created_at"],"unique":true}],"plainIndexes":[{"fieldNames":["status","created_at"]}],"ginIndexes":[{"fieldName":"reason"}]},{"name":"shopping_mall_ai_backend_inquiry_moderation_events","description":"Chronological record of moderation actions/events affecting inquiries or abuse reports. Links actions to target inquiry, reply, or abuse report, records moderator/admin, event type (e.g., review, rejection, restoration), timestamp, and any rationale notes. Critical for compliance and audit trails. Managed only via admin/mod console.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"inquiry_id","type":"uuid","description":"Target inquiry's {@link shopping_mall_ai_backend_inquiries.id}, nullable if action relates directly to reply or report.","relation":{"name":"inquiry","targetModel":"shopping_mall_ai_backend_inquiries"},"unique":false,"nullable":true},{"name":"reply_id","type":"uuid","description":"Target reply's {@link shopping_mall_ai_backend_inquiry_replies.id}, nullable.","relation":{"name":"reply","targetModel":"shopping_mall_ai_backend_inquiry_replies"},"unique":false,"nullable":true},{"name":"abuse_report_id","type":"uuid","description":"Target abuse report's {@link shopping_mall_ai_backend_inquiry_abuse_reports.id}, nullable.","relation":{"name":"abuseReport","targetModel":"shopping_mall_ai_backend_inquiry_abuse_reports"},"unique":false,"nullable":true},{"name":"admin_id","type":"uuid","description":"Administrator or moderator responsible for this action. {@link shopping_mall_ai_backend_admins.id}.","relation":{"name":"admin","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":false}],"plainFields":[{"name":"event_type","type":"string","description":"Event type (e.g., review, resolve, reject, restore, escalate).","nullable":false},{"name":"note","type":"string","description":"Rationale or moderation note (freeform, optional).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp this moderation event was logged.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["inquiry_id","abuse_report_id","created_at"]}],"ginIndexes":[{"fieldName":"note"}]},{"name":"shopping_mall_ai_backend_inquiry_faq_suggestions","description":"Records AI-generated or admin-added FAQ suggestions linked to inquiries, with rationale, FAQ question/answer, system/admin status, and timestamp. Provides an audit trail of suggested/helpful resources for user or moderation workflows. Not directly managed by users; exists to support moderation and ML/AI explainability.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"inquiry_id","type":"uuid","description":"Inquiry for which FAQ is suggested. {@link shopping_mall_ai_backend_inquiries.id}.","relation":{"name":"inquiry","targetModel":"shopping_mall_ai_backend_inquiries"},"unique":false,"nullable":false},{"name":"admin_id","type":"uuid","description":"Admin who confirmed/suggested/explained the FAQ. {@link shopping_mall_ai_backend_admins.id}, nullable if suggested by AI only.","relation":{"name":"admin","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":true}],"plainFields":[{"name":"faq_question","type":"string","description":"FAQ question suggested for user.","nullable":false},{"name":"faq_answer","type":"string","description":"Suggested FAQ answer content.","nullable":false},{"name":"suggestion_type","type":"string","description":"How the FAQ was suggested (AI, admin, manual, ML-model, review).","nullable":false},{"name":"status","type":"string","description":"Status (suggested, accepted, dismissed, outdated, replaced).","nullable":false},{"name":"note","type":"string","description":"Explanation rationale, evidence, or ML/service reference for why the FAQ was suggested (optional).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp of FAQ suggestion creation.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["inquiry_id","suggestion_type","created_at"]}],"ginIndexes":[{"fieldName":"faq_question"},{"fieldName":"faq_answer"}]}]},{"filename":"schema-09-favorites.prisma","namespace":"Favorites","models":[{"name":"shopping_mall_ai_backend_favorites","description":"Core business entity for a user's favorite item bookmark. Stores evidence of favorite creation, snapshotting relevant target details at the time of favoriting for audit and notification. May reference product, address, inquiry via mapping tables. Supports audit/evidence and notification functions. Each favorite belongs to a user and may be grouped via favorite folders.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Belonged customer's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_favorite_folder_id","type":"uuid","description":"Optional reference to a favorite folder grouping {@link shopping_mall_ai_backend_favorite_folders.id}.","relation":{"name":"favoriteFolder","targetModel":"shopping_mall_ai_backend_favorite_folders"},"unique":false,"nullable":true}],"plainFields":[{"name":"title_snapshot","type":"string","description":"Snapshot of the target item's title at the time of favoriting (for evidence/notification).","nullable":true},{"name":"target_type","type":"string","description":"Type of favorite target: 'product', 'address', 'inquiry', etc. Used for resolving the mapping table.","nullable":false},{"name":"target_id_snapshot","type":"string","description":"Snapshot/cached identifier of the target entity (e.g., product code, address ID). For evidence even if original is removed.","nullable":true},{"name":"created_at","type":"datetime","description":"Favorite creation timestamp (evidence trail).","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last modification timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-delete timestamp for logical deletion.","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id","target_type","target_id_snapshot"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"]},{"fieldNames":["target_type","target_id_snapshot"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"title_snapshot"}]},{"name":"shopping_mall_ai_backend_favorite_products","description":"Mapping/supporting table for users' favorited products. Enables notification to the user about product changes. References both favorite and product IDs; preserves evidence. Used for personalizing product experiences and batch operations.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_favorite_id","type":"uuid","description":"Referenced favorite entity’s {@link shopping_mall_ai_backend_favorites.id}.","relation":{"name":"favorite","targetModel":"shopping_mall_ai_backend_favorites"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_product_id","type":"uuid","description":"Favorited product {@link shopping_mall_ai_backend_products.id}.","relation":{"name":"product","targetModel":"shopping_mall_ai_backend_products"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Mapping creation time.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_favorite_id","shopping_mall_ai_backend_product_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_product_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_favorite_addresses","description":"Mapping/support table for address favorites. Supports personalized checkout experience and fast address selection. Each record connects a favorite entity with a referenced address. Snapshotting provides evidence for future data integrity or notification.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_favorite_id","type":"uuid","description":"Favorite entity’s {@link shopping_mall_ai_backend_favorites.id}.","relation":{"name":"favorite","targetModel":"shopping_mall_ai_backend_favorites"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Owner of the favorite. References {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"address_snapshot","type":"string","description":"Cached address details for audit history and evidence. Used if address is changed or deleted.","nullable":true},{"name":"created_at","type":"datetime","description":"Mapping creation time for audit trail.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_favorite_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"]}],"ginIndexes":[{"fieldName":"address_snapshot"}]},{"name":"shopping_mall_ai_backend_favorite_inquiries","description":"Mapping/supporting table connecting user favorites to inquiries (Q&A, help lines, support threads, etc.). Supports user notification for new answers and evidence preservation if inquiry content changes. Each record references a favorite and target inquiry.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_favorite_id","type":"uuid","description":"Favorite entity’s {@link shopping_mall_ai_backend_favorites.id}.","relation":{"name":"favorite","targetModel":"shopping_mall_ai_backend_favorites"},"unique":false,"nullable":false},{"name":"shopping_mall_ai_backend_inquiry_id","type":"uuid","description":"Favorited inquiry {@link shopping_mall_ai_backend_inquiries.id}.","relation":{"name":"inquiry","targetModel":"shopping_mall_ai_backend_inquiries"},"unique":false,"nullable":false}],"plainFields":[{"name":"inquiry_snapshot","type":"string","description":"Cached/inlined inquiry title/body details for tracking, notification, and evidence of status/content at favoriting time.","nullable":true},{"name":"created_at","type":"datetime","description":"Mapping creation timestamp for evidence/audit.","nullable":false}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_favorite_id","shopping_mall_ai_backend_inquiry_id"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_inquiry_id"]}],"ginIndexes":[{"fieldName":"inquiry_snapshot"}]},{"name":"shopping_mall_ai_backend_favorite_folders","description":"User-customizable folders/tags used to organize favorites for management and notification grouping. Each folder belongs to a customer and may be referenced by many favorites. Enables customized notification and grouping logic for better user experience.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"shopping_mall_ai_backend_customer_id","type":"uuid","description":"Folder owner's {@link shopping_mall_ai_backend_customers.id}.","relation":{"name":"customer","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","description":"Folder name or tag set by user for organization.","nullable":false},{"name":"description","type":"string","description":"Optional folder description (user notes).","nullable":true},{"name":"created_at","type":"datetime","description":"Folder creation time (auditable).","nullable":false},{"name":"updated_at","type":"datetime","description":"Last folder update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-delete timestamp for logical deletion (folder hidden, not removed).","nullable":true}],"uniqueIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["shopping_mall_ai_backend_customer_id"]}],"ginIndexes":[{"fieldName":"name"}]}]},{"filename":"schema-10-articles.prisma","namespace":"Articles","models":[{"name":"shopping_mall_ai_backend_articles","description":"Holds core article content for community/post/notice board. Business entity for all user- and admin-generated long-form content, supporting publishing, editing, per-article moderation, cross-channel posting, and policy compliance. Related to comments, attachments, categories, tags, and has full versioning via snapshots.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"channel_id","type":"uuid","description":"Associated channel's {@link shopping_mall_ai_backend_channels.id}. Determines which sales or content channel article belongs to.","relation":{"name":"channel","targetModel":"shopping_mall_ai_backend_channels"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","description":"Article title, used for navigation, search, and channel display. Must be concise and business-relevant.","nullable":false},{"name":"body","type":"string","description":"Main content body (supports multi-format text: markdown, HTML, plaintext).","nullable":false},{"name":"author_id","type":"uuid","description":"Business author reference (admin, seller, or customer) as policy allows. References user entity by type. Polymorphic but required (resolved in business logic).","nullable":false},{"name":"pinned","type":"boolean","description":"Whether the article is pinned to the top (e.g., as announcement or notice). Used by admins or sellers for channel comms.","nullable":false},{"name":"status","type":"string","description":"Publication status: e.g. draft, published, archived, hidden. Keeps logical state for workflow control.","nullable":false},{"name":"view_count","type":"int","description":"Number of times article has been viewed. Updated independently; not used for materialized view in base table.","nullable":false},{"name":"is_notice","type":"boolean","description":"Whether this article is a formal notice (shown in separate notice boards).","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp. Used for sorting and audit.","nullable":false},{"name":"updated_at","type":"datetime","description":"Update timestamp, modified on every content or metadata update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Logical deletion time (soft-delete). If null, record is active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["channel_id","title"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]},{"fieldNames":["status"]},{"fieldNames":["author_id"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"body"}]},{"name":"shopping_mall_ai_backend_article_comments","description":"Business entity for user-generated comments on articles. Each comment may have replies or be standalone. Requires moderation and audit. Cross-article search supported, e.g. by user or keyword.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"article_id","type":"uuid","description":"The {@link shopping_mall_ai_backend_articles.id} this comment belongs to.","relation":{"name":"article","targetModel":"shopping_mall_ai_backend_articles"},"unique":false,"nullable":false},{"name":"parent_id","type":"uuid","description":"Self-reference to parent comment for replies. Enables multi-depth threads. Optional: root comments will be null.","relation":{"name":"parent","targetModel":"shopping_mall_ai_backend_article_comments","mappingName":"recursive"},"unique":false,"nullable":true},{"name":"author_id","type":"uuid","description":"Commenting user's entity (customer/admin/seller as per policy).","relation":{"name":"author","targetModel":"shopping_mall_ai_backend_customers"},"unique":false,"nullable":false}],"plainFields":[{"name":"body","type":"string","description":"Comment content (plaintext or formatted as required).","nullable":false},{"name":"is_secret","type":"boolean","description":"Whether the comment is private/secret (e.g. Q&A only visible to customer/seller/admins).","nullable":false},{"name":"status","type":"string","description":"Moderation/publication status: e.g., visible, hidden, flagged.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when comment was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Logical deletion for audit/evidence. If null comment is active.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["article_id","created_at"]},{"fieldNames":["author_id","created_at"]}],"ginIndexes":[{"fieldName":"body"}]},{"name":"shopping_mall_ai_backend_article_categories","description":"Business taxonomy for organizing articles into hierarchical or flat categories. Used for filtering, navigation, and analytics. Each category can be top-level or nested. Centralized management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"parent_id","type":"uuid","description":"Optional parent for hierarchical categories (self-reference). Enables nesting (e.g. Announcement > Event).","relation":{"name":"parent","targetModel":"shopping_mall_ai_backend_article_categories","mappingName":"recursive"},"unique":false,"nullable":true}],"plainFields":[{"name":"channel_id","type":"uuid","description":"Channel to which this category belongs. Enables different category trees by channel.","nullable":false},{"name":"name","type":"string","description":"Category name, unique per channel tree.","nullable":false},{"name":"description","type":"string","description":"Short description or guidelines about category purpose and scope.","nullable":true},{"name":"order","type":"int","description":"Sort order within sibling categories (for navigation menus etc.).","nullable":false},{"name":"created_at","type":"datetime","description":"Category creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update/modified date.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft-deleted time for audit; null if active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["channel_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["parent_id"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"shopping_mall_ai_backend_article_tags","description":"Article tagging entity supporting flexible, multi-instance tagging. Tags can be managed as a controlled list or ad-hoc. Used for classification, navigation, and analytics; not a primary entity but supports many-to-many mapping.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"article_id","type":"uuid","description":"The {@link shopping_mall_ai_backend_articles.id} this tag is assigned to.","relation":{"name":"article","targetModel":"shopping_mall_ai_backend_articles"},"unique":false,"nullable":false}],"plainFields":[{"name":"tag","type":"string","description":"Single tag text (e.g. 'FAQ', 'Update', 'Event'). Used for navigation/analytics.","nullable":false}],"uniqueIndexes":[{"fieldNames":["article_id","tag"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"tag"}]},{"name":"shopping_mall_ai_backend_article_attachments","description":"File/attachment entity for linking files to articles or comments. Holds reference to uploaded file metadata, enabling flexible file management for images or documents related to content. Managed only through parent entities (not standalone).","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"article_id","type":"uuid","description":"The {@link shopping_mall_ai_backend_articles.id} this file is attached to. Mutually exclusive with comment (one must be present).","relation":{"name":"article","targetModel":"shopping_mall_ai_backend_articles"},"unique":false,"nullable":true},{"name":"comment_id","type":"uuid","description":"The {@link shopping_mall_ai_backend_article_comments.id} comment this attachment belongs to; for images/etc in discussions. Only one of article/comment set.","relation":{"name":"comment","targetModel":"shopping_mall_ai_backend_article_comments"},"unique":false,"nullable":true},{"name":"file_id","type":"uuid","description":"Actual attachment file's {@link shopping_mall_ai_backend_files.id}. References physical file metadata managed by ops.","relation":{"name":"file","targetModel":"shopping_mall_ai_backend_files"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","description":"Attachment registration time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Logical deletion (if present, record is no longer visible).","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["file_id"]}],"ginIndexes":[]},{"name":"shopping_mall_ai_backend_article_snapshots","description":"Immutable snapshots for all business state changes to articles. Every edit, publish, delete, etc. creates a full copy, enabling audit, rollback, and compliance evidence. Not directly user-editable. Used for legal, compliance, and business analysis.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"article_id","type":"uuid","description":"Target article's {@link shopping_mall_ai_backend_articles.id} at this snapshot event.","relation":{"name":"article","targetModel":"shopping_mall_ai_backend_articles"},"unique":false,"nullable":false},{"name":"editor_id","type":"uuid","description":"Business entity that triggered the snapshot (admin/customer/seller, as allowed).","relation":{"name":"editor","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","description":"Title at the time of snapshot (immutable; preserved for evidence).","nullable":false},{"name":"body","type":"string","description":"Content at time of snapshot (immutable full copy, includes all business data for compliance/legal trace).","nullable":false},{"name":"status","type":"string","description":"Publication status at the time of snapshot (e.g., draft, published, archived).","nullable":false},{"name":"is_notice","type":"boolean","description":"Notice status as of snapshot (copied from article).","nullable":false},{"name":"pinned","type":"boolean","description":"Pinned-flag, copied at time of snapshot; supports rollback/audit.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when snapshot created (event time, not original article time).","nullable":false}],"uniqueIndexes":[{"fieldNames":["article_id","created_at"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"title"},{"fieldName":"body"}]},{"name":"shopping_mall_ai_backend_article_moderation_logs","description":"Event log for all moderation, review, flagging, or compliance actions associated with articles or comments. Audit trail for interventions, supporting business/legal disputes. Each log may reference article or comment, or both, and records moderator who acted.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"article_id","type":"uuid","description":"Related article's {@link shopping_mall_ai_backend_articles.id}; may be null if log relates to comment only.","relation":{"name":"article","targetModel":"shopping_mall_ai_backend_articles"},"unique":false,"nullable":true},{"name":"comment_id","type":"uuid","description":"Related comment's {@link shopping_mall_ai_backend_article_comments.id}; null unless event targeted at comment (vs article).","relation":{"name":"comment","targetModel":"shopping_mall_ai_backend_article_comments"},"unique":false,"nullable":true},{"name":"moderator_id","type":"uuid","description":"Moderator/admin entity who performed moderation action.","relation":{"name":"moderator","targetModel":"shopping_mall_ai_backend_admins"},"unique":false,"nullable":false}],"plainFields":[{"name":"action","type":"string","description":"Describes moderation event (flagged, approved, removed, warned, restored etc.)","nullable":false},{"name":"reason","type":"string","description":"Details for evidence: explicit reasoning, user report, compliance policy etc.","nullable":false},{"name":"evidence_file_id","type":"uuid","description":"Optional reference to evidence file (if provided as proof, screenshot, etc.).","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp for moderation event.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["moderator_id"]}],"ginIndexes":[{"fieldName":"action"},{"fieldName":"reason"}]}]}]}